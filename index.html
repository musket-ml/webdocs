<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="None">
  
  
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Musket ML</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="css/theme.css" />
  <link rel="stylesheet" href="css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Home";
    var mkdocs_page_input_path = "index.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/Python.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="." class="icon icon-home"> Musket ML</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">Generic</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="generic/">User guide</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="generic/#reasons-to-use-generic-pipeline">Reasons to use Generic Pipeline</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#installation">Installation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#project-structure">Project structure</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#launching">Launching</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#general-train-properties">General train properties</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#definining-networks">Definining networks</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="generic/#built-in-nn-layers">Built-in NN layers</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/#control-layers">Control layers</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="generic/#simple-data-flow-constructions">Simple Data Flow constructions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="generic/#repeat-and-with">Repeat and With</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="generic/#conditional-layers">Conditional layers</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="generic/#shared-weights">Shared Weights</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="generic/#wrapper-layers">Wrapper layers</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="generic/#manually-controlling-data-flow">Manually controlling data flow</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#datasets">Datasets</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#callbacks">Callbacks</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#stages">Stages</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#preprocessors">Preprocessors</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/#how-to-check-training-results">How to check training results</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="generic/reference/">Reference</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="generic/reference/#pipeline-root-properties">Pipeline root properties</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#activation">activation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#aggregation_metric">aggregation_metric</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#architecture">architecture</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#augmentation">augmentation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#batch">batch</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#classes">classes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#callbacks">callbacks</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#copyweights">copyWeights</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#clipnorm">clipnorm</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#clipvalue">clipvalue</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#dataset">dataset</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#datasets">datasets</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#dataset_augmenter">dataset_augmenter</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#dropout">dropout</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#declarations">declarations</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#extra_train_data">extra_train_data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#folds_count">folds_count</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#freeze_encoder">freeze_encoder</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#final_metrics">final_metrics</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#holdout">holdout</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#imports">imports</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#inference_batch">inference_batch</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#loss">loss</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#lr">lr</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#metrics">metrics</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#num_seeds">num_seeds</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#optimizer">optimizer</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#primary_metric">primary_metric</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#primary_metric_mode">primary_metric_mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#preprocessing">preprocessing</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#random_state">random_state</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#stages">stages</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#stratified">stratified</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#testsplit">testSplit</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#testsplitseed">testSplitSeed</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#testtimeaugmentation">testTimeAugmentation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#transforms">transforms</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#validationsplit">validationSplit</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/reference/#callback-types">Callback types</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#earlystopping">EarlyStopping</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#reducelronplateau">ReduceLROnPlateau</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#cycliclr">CyclicLR</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#lrvariator">LRVariator</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#tensorboard">TensorBoard</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/reference/#layer-types">Layer types</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#input">Input</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#gaussiannoise">GaussianNoise</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#dropout_1">Dropout</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#spatialdropout1d">SpatialDropout1D</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#lstm">LSTM</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#globalmaxpool1d">GlobalMaxPool1D</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#globalaveragepooling1d">GlobalAveragePooling1D</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#batchnormalization">BatchNormalization</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#concatenate">Concatenate</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#add">Add</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#substract">Substract</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#mult">Mult</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#max">Max</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#min">Min</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#conv1d">Conv1D</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#conv2d">Conv2D</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#maxpool1d">MaxPool1D</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#maxpool2d">MaxPool2D</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#averagepooling1d">AveragePooling1D</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#cudnnlstm">CuDNNLSTM</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#dense">Dense</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#flatten">Flatten</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#bidirectional">Bidirectional</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/reference/#utility-layers">Utility layers</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split">split</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-concat">split-concat</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-concatenate">split-concatenate</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-add">split-add</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-substract">split-substract</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-mult">split-mult</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-min">split-min</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-max">split-max</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-dot">split-dot</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-dot-normalize">split-dot-normalize</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#seq">seq</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#input_1">input</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#pass">pass</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#transform-concat">transform-concat</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#transform-add">transform-add</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/reference/#stage-properties">Stage properties</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#loss_1">loss</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#lr_1">lr</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#initial_weights">initial_weights</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#epochs">epochs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#unfreeze_encoder">unfreeze_encoder</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#callbacks_1">callbacks</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#extra_callbacks">extra_callbacks</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="generic/reference/#preprocessors">Preprocessors</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#cache">cache</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#disk-cache">disk-cache</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-preprocessor">split-preprocessor</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#split-concat-preprocessor">split-concat-preprocessor</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#seq-preprocessor">seq-preprocessor</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="generic/reference/#augmentation_1">augmentation</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Segmentation</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="segmentation/">User guide</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/#motivation">Motivation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/#installation">Installation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/#usage-guide">Usage guide</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/#training-a-model">Training a model</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#image-and-mask-augmentations">Image and Mask Augmentations</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#freezing-and-unfreezing-encoder">Freezing and Unfreezing encoder</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#custom-datasets">Custom datasets</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#balancing-your-data">Balancing your data</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#multistage-training">Multistage training</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#composite-losses">Composite losses</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#cyclical-learning-rates">Cyclical learning rates</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#lr-finder">LR Finder</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#background-augmenter">Background Augmenter</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#training-on-crops">Training on crops</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/#using-trained-model">Using trained model</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="segmentation/#ensembling-predictions">Ensembling predictions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/#custom-evaluation-code">Custom evaluation code</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/#accessing-model">Accessing model</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/#analyzing-experiments-results">Analyzing experiments results</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/#what-is-supported">What is supported?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/#custom-architectures-callbacks-metrics">Custom architectures, callbacks, metrics</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/#examples">Examples</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="segmentation/reference/">Reference</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/reference/#pipeline-root-properties">Pipeline root properties</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#activation">activation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#aggregation_metric">aggregation_metric</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#architecture">architecture</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#augmentation">augmentation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#backbone">backbone</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#batch">batch</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#classifier">classifier</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#classifier_lr">classifier_lr</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#classes">classes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#callbacks">callbacks</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#compresspredictionsasints">compressPredictionsAsInts</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#copyweights">copyWeights</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#clipnorm">clipnorm</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#clipvalue">clipvalue</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#crops">crops</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#dataset">dataset</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#datasets">datasets</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#dataset_augmenter">dataset_augmenter</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#dropout">dropout</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#encoder_weights">encoder_weights</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#extra_train_data">extra_train_data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#folds_count">folds_count</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#freeze_encoder">freeze_encoder</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#final_metrics">final_metrics</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#holdout">holdout</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#imports">imports</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#inference_batch">inference_batch</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#loss">loss</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#lr">lr</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#manualresize">manualResize</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#metrics">metrics</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#num_seeds">num_seeds</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#optimizer">optimizer</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#primary_metric">primary_metric</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#primary_metric_mode">primary_metric_mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#preprocessing">preprocessing</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#random_state">random_state</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#shape">shape</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#stages">stages</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#stratified">stratified</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#testsplit">testSplit</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#testsplitseed">testSplitSeed</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#testtimeaugmentation">testTimeAugmentation</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#transforms">transforms</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#validationsplit">validationSplit</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/reference/#callback-types">Callback types</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#earlystopping">EarlyStopping</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#reducelronplateau">ReduceLROnPlateau</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#cycliclr">CyclicLR</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#lrvariator">LRVariator</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#tensorboard">TensorBoard</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/reference/#stage-properties">Stage properties</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#loss_1">loss</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#lr_1">lr</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#initial_weights">initial_weights</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#epochs">epochs</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#unfreeze_encoder">unfreeze_encoder</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#callbacks_1">callbacks</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#extra_callbacks">extra_callbacks</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="segmentation/reference/#preprocessors">Preprocessors</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#cache">cache</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#disk-cache">disk-cache</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#split-preprocessor">split-preprocessor</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#split-concat-preprocessor">split-concat-preprocessor</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#seq-preprocessor">seq-preprocessor</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="segmentation/reference/#augmentation_1">augmentation</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Classification</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="classification/">User guide</a>
    <ul>
    <li class="toctree-l2"><a class="reference internal" href="classification/#motivation">Motivation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="classification/#installation">Installation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="classification/#usage-guide">Usage guide</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="classification/#training-a-model">Training a model</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="classification/#image-augmentations">Image Augmentations</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="classification/#freezingunfreezing-encoder">Freezing/Unfreezing encoder</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="classification/#custom-datasets">Custom datasets</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="classification/#balancing-your-data">Balancing your data</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="classification/#multistage-training">Multistage training</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="classification/#composite-losses">Composite losses</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="classification/#cyclical-learning-rates">Cyclical learning rates</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="classification/#lr-finder">LR Finder</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="classification/#training-on-crops">Training on crops</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="classification/#using-trained-model">Using trained model</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="classification/#ensembling-predictions">Ensembling predictions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="classification/#custom-evaluation-code">Custom evaluation code</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="classification/#accessing-model">Accessing model</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="classification/#analyzing-experiments-results">Analyzing experiments results</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="classification/#what-is-supported">What is supported?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="classification/#custom-architectures-callbacks-metrics">Custom architectures, callbacks, metrics</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="classification/reference/">Reference</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href=".">Musket ML</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Home</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="you-have-just-found-musket">You have just found Musket</h1>
<p>Musket is a family of high-level frameworks written in Python and capable of running on top of <a href="https://keras.io/">Keras</a>.</p>
<p>It was developed with a focus of enabling to make fast and simply-declared experiments, which can be easily stored, reproduced and compared to each other.</p>
<p>Use Musket if you need a deep learning framework that:</p>
<ul>
<li>Allows to describe experiments in a compact and expressive way</li>
<li>Provides a way to store and compare experiments in order to methodically find the best deap learning solution</li>
<li>Easy to share experiments and their results to work in a team</li>
<li>Provides IDE and visual tooling to make experimentation faster</li>
</ul>
<h1 id="goals-and-principles">Goals and principles</h1>
<h3 id="compactness-and-declarative-description">Compactness and declarative description</h3>
<p>Declarative description is always more compact and human-readable
than imperative description.</p>
<p>All experiments are declared in YAML dialect with lots of defaults, allowing to describe an initial experiment in several lines and then set more details if needed.</p>
<p>This is a simple classification experiment, and half of these instructions can be actually omitted:</p>
<pre><code class="yaml">#%Musket Classification 1.0
architecture: Xception
classes: 101
activation: softmax
weights: imagenet
shape: [512, 512, 4]
optimizer: Adam
batch: 8
lr: 0.001
primary_metric: val_macro_f1
primary_metric_mode: max
dataset:
  combinations_train: []
</code></pre>

<h3 id="reproducibility-and-ease-of-sharing">Reproducibility and ease of sharing</h3>
<p>As each experiment is simply a folder with YAML file inside, it is easy to store and run experiment.</p>
<p>Putting YAML files into git or sharing them in other way provides other team members with an easy way to reproduce the same experiments locally.
Anyone can check your experiments, and add their own to the storage as the storage is simply a folder.</p>
<h3 id="established-way-to-store-and-compare-results">Established way to store and compare results</h3>
<p>Musket is lazy by its nature. Each experiment starts with a simple YAML description. There may be many stages in training and prediction, starting with calculating datasets, preprocessing and finishing with inferring and calculating statistics, but for each stage Musket saves results in the sub-folders of experiment folder.</p>
<p>When the experiment is launched, Musket checks, which result files are already in place and only runs what is needed. It is up to team members, what to share: pure YAML desciptions, YAML and final metrics (to compare experiment effectiveness), or also, potentially more heavy intermediate results so other team members can run experiments faster locally.</p>
<p>It is easy to compare two experiments with each other by running any text compare tooling, experiments are just YAML text:</p>
<p><img alt="YAML comparison" src="images/compare.png" /></p>
<p>As all experiment statistics is also saved as files, it is easy to compare experiment results and find the best ones by the same text files comparison tooling.</p>
<p>IDE helps here, too, by adding results visualisation tooling.</p>
<h3 id="flexibility-and-extensibility">Flexibility and extensibility</h3>
<p>Declarative approach is good and compact, but sometimes we want to define some custom functionality.</p>
<p>Musket supports lots of custom substances: dataset definitions, preprocessors, custom network layers, visualizers etc etc.</p>
<p>Most of the time to define a custom thing, it is enough to put a python file into a top-level folder and define a function with an appropriate annotation, like this:</p>
<pre><code class="python">@preprocessing.dataset_preprocessor
def splitInput(input, parts:int):
    result = np.array_split(input,parts,axis=0)
    return result
</code></pre>

<p>or this:</p>
<pre><code class="python">@dataset_visualizer
def visualize(val:PredictionItem):
    cache_path=context().path
    path = cache_path + &quot;/&quot; + str(val.id) + &quot;.png&quot;
    if os.path.exists(path):
        return path
    ma = val.x/128 - preprocessors.moving_average(val.x/128, 8000)
    std = np.std(ma)

    ma[np.where(np.abs(ma) - 2 * std &lt; 0)] = 0
    v = ma
    fig, axs = plt.subplots(1, 1, constrained_layout=True, figsize=(15, 10))

    v[:, 0] += 1
    v[:, 2] -= 1

    plt.ylim(-2, 2)
    axs.plot(v[:, 0], label='Phase 0')
    axs.plot(v[:, 1], label='Phase 1')
    axs.plot(v[:, 2], label='Phase 2')
    axs.legend()
    if sum(val.y) &gt; 0:
        axs.set_title('bad wire:' + str(val.id))

        plt.savefig(path)
    else:
        axs.set_title('normal wire:' + str(val.id))
        plt.savefig(path)
    try:    
        plt.close()
    except:
        pass    
    return path

</code></pre>

<h1 id="pipelines-and-ide">Pipelines and IDE</h1>
<p>Musket is family of frameworks, not a single framework for a reason.</p>
<p>There is a core part, a pipeline called <a href="generic/">Generic Pipeline</a>, which is quite universal and can handle any type of tasks.</p>
<p>Besides it, there are also specialized pipelines with YAML domain syntax better suited for a particular task like
<a href="segmentation/">Segmentation Pipeline</a> or <a href="classification/">Classification Pipeline</a>. Such specialized frameworks has reduced flexibility, but more rapid prototyping and a whole set of useful built-ins.</p>
<p>All of those pipelines are supported by musket IDE, which simplifies experiment running and result analysis.</p>
<p><img alt="YAML comparison" src="images/architecture.png" /></p>
<h2 id="generic-pipeline"><a href="generic/">Generic pipeline</a></h2>
<p><a href="generic/">Generic pipeline</a> has the most universal YAML-based domain-specific syntax of all pipelines.
Its main feature is an ability to define custom neural networks in a declarative manner by declaring blocks basing on built-in blocks, and then referring custom blocks from other custom blocks.</p>
<p>There is also a rich set of declarative instructions that control dataflow inside the network.
Most elements like datasets, preprocessors, network blocks, loss functions, metrics etc can be customly defined in python code and later reused from YAML.</p>
<pre><code class="yaml">imports: [ layers, preprocessors ]
declarations:
  collapseConv:
    parameters: [ filters,size, pool]
    body:
      - conv1d: [filters,size,relu ]
      - conv1d: [filters,size,relu ]
      - batchNormalization: {}
      - collapse: pool
  net:
    #- gaussianNoise: 0.0001
    - repeat(2):
      - collapseConv: [ 20, 7, 10 ]

    - cudnnlstm: [40, true ]
    - cudnnlstm: [40, true ]
    - attention: 718
    - dense: [3, sigmoid]
  preprocess:
     - rescale: 10
     - get_delta_from_average
     - cache
preprocessing: preprocess
testSplit: 0.4
architecture: net
optimizer: Adam #Adam optimizer is a good default choice
batch: 12 #Our batch size will be 16
metrics: #We would like to track some metrics
  - binary_accuracy
  - matthews_correlation
primary_metric: val_binary_accuracy #and the most interesting metric is val_binary_accuracy
callbacks: #Let's configure some minimal callbacks
  EarlyStopping:
    patience: 100
    monitor: val_binary_accuracy
    verbose: 1
  ReduceLROnPlateau:
    patience: 8
    factor: 0.5
    monitor: val_binary_accuracy
    mode: auto
    cooldown: 5
    verbose: 1
loss: binary_crossentropy #We use simple binary_crossentropy loss
stages:
  - epochs: 100 #Let's go for 100 epochs
  - epochs: 100 #Let's go for 100 epochs
  - epochs: 100 #Let's go for 100 epochs
</code></pre>

<h2 id="segmentation-pipeline"><a href="segmentation/">Segmentation Pipeline</a></h2>
<p><a href="segmentation/">Segmentation Pipeline</a> has a lot of common parts with <a href="generic/">Generic pipeline</a>, but it is much easier to define an architecture of the network, just name it:</p>
<pre><code class="yaml">backbone: mobilenetv2 #let's select classifier backbone for our network 
architecture: DeepLabV3 #let's select segmentation architecture that we would like to use
augmentation:
 Fliplr: 0.5 #let's define some minimal augmentations on images
 Flipud: 0.5 
classes: 1 #we have just one class (mask or no mask)
activation: sigmoid #one class means that our last layer should use sigmoid activation
encoder_weights: pascal_voc #we would like to start from network pretrained on pascal_voc dataset
shape: [320, 320, 3] #This is our desired input image and mask size, everything will be resized to fit.
optimizer: Adam #Adam optimizer is a good default choice
batch: 16 #Our batch size will be 16
metrics: #We would like to track some metrics
  - binary_accuracy 
  - iou
primary_metric: val_binary_accuracy #and the most interesting metric is val_binary_accuracy
callbacks: #Let's configure some minimal callbacks
  EarlyStopping:
    patience: 15
    monitor: val_binary_accuracy
    verbose: 1
  ReduceLROnPlateau:
    patience: 4
    factor: 0.5
    monitor: val_binary_accuracy
    mode: auto
    cooldown: 5
    verbose: 1
loss: binary_crossentropy #We use simple binary_crossentropy loss
stages:
  - epochs: 100 #Let's go for 100 epochs
</code></pre>

<h2 id="classification-pipeline"><a href="classification/">Classification Pipeline</a></h2>
<p><a href="classification/">Classification Pipeline</a> has a lot of common parts with <a href="generic/">Generic pipeline</a> too, and as in <a href="segmentation/">Segmentation Pipeline</a> it is easy to define an architecture of the network, just name it and set the number of output classes:</p>
<pre><code class="yaml">architecture: DenseNet201 #pre-trained model we are going to use
pooling: avg
augmentation: #define some minimal augmentations on images
 Fliplr: 0.5
 Flipud: 0.5
classes: 28 #define the number of classes
activation: sigmoid #as we have multilabel classification, the activation for last layer is sigmoid
weights: imagenet #we would like to start from network pretrained on imagenet dataset
shape: [224, 224, 3] #our desired input image size, everything will be resized to fit
optimizer: Adam #Adam optimizer is a good default choice
batch: 16 #our batch size will be 16
lr: 0.005
copyWeights: true
metrics: #we would like to track some metrics
  - binary_accuracy
  - macro_f1
primary_metric: val_binary_accuracy #the most interesting metric is val_binary_accuracy
primary_metric_mode: max
callbacks: #configure some minimal callbacks
  EarlyStopping:
    patience: 3
    monitor: val_macro_f1
    mode: max
    verbose: 1
  ReduceLROnPlateau:
    patience: 2
    factor: 0.3
    monitor: val_binary_accuracy
    mode: max
    cooldown: 1
    verbose: 1
loss: binary_crossentropy #we use binary_crossentropy loss
stages:
  - epochs: 10 #let's go for 100 epochs
</code></pre>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
        <span style="margin-left: 15px"><a href="generic/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>
    <script type="text/javascript" defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(false);
        };
    </script>

</body>
</html>

<!--
MkDocs version : 1.0.4
Build Date UTC : 2019-08-26 16:19:28
-->
